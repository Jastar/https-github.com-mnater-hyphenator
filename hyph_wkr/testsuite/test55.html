<!DOCTYPE HTML>
<html lang="de">
    <head>
        <title>Hyphenator.js &ndash; Test 55</title>
        <meta http-equiv="content-type" content="text/html; charset=UTF-8">
        <style type="text/css">
            body {
                width:50%;
                margin-left:25%;
                margin-right:25%;
            }
            #test {
            	background-color: #ffd6d6;
            }
            #ref {
            	background-color: #d6ffd6;
            }
        </style>
    </head>
    <body>
		<p><a href="test54.html">&lt;- Prev</a> | <a href="test56.html">Next -&gt;</a></p>
        <h1>Test 55</h1>
        <p id="desc">Extending String by String.prototype.hyphenate</p>
        <p id="ref">alerts: Hy|phen|ation</p>
        <script type="text/javascript">
			String.prototype.hyphenate = function(lang, wordhyphenchar) {
			
				var
				hyphenator = new Worker('../Hyphenator_worker.js'),
				wordhyphenchar = wordhyphenchar || String.fromCharCode(173),
				text = this, messageCount = 0, done, wait;

				hyphenator.postMessage(JSON.stringify({
					type: 'config',
					wordhyphenchar: wordhyphenchar
				}));
	
				hyphenator.onmessage = function (e) {
					var msg = JSON.parse(e.data);
					if (msg.type === 'hyphenate') {
						text = msg.text;
						messageCount--;
					}
				};

				hyphenator.postMessage(JSON.stringify({
					type: 'hyphenate',
					text: text,
					lang: 'en'
				}));
				messageCount++;
				
				if (messageCount === 0) {
					return text;
				} else {
					return text;
				}
				alert('exit');
			}
			alert('Hyphenation'.hyphenate('en', '|'));
        </script>

     </body>
</html>